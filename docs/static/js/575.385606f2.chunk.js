/*! For license information please see 575.385606f2.chunk.js.LICENSE.txt */
(self.webpackChunkminkiele_github_io=self.webpackChunkminkiele_github_io||[]).push([[575],{575:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var r=n(942),i=n(885),s=n(123),o=n.n(s),a=n(904),u=n(363),c=n(413),l=n(671),h=n(144),f=n(136),p=n(104),d=n(41),v=function(e){(0,f.Z)(n,e);var t=(0,p.Z)(n);function n(e,r){var i;return(0,l.Z)(this,n),(i=t.call(this)).speed=1,i.status=n.STATUS.IDLE,i.headIndex=0,i.hasWalls=!0,i.snake=i.getNewSnake(),i.apple=i.getNewAppleCoords(),i.currentDirection=n.DIRECTION.R,i.nextDirection=void 0,i.timerId=void 0,null!=e&&i.setSpeed(e),null!=r&&i.setWalls(r),i}return(0,h.Z)(n,[{key:"refreshSpeed",get:function(){return 1e3/this.speed}},{key:"tailIndex",get:function(){return this.snake.length-1}},{key:"getStatus",value:function(){return this.status}},{key:"times",value:function(e,t){return Array(t).fill(void 0).map((function(t,n){return e(n)}))}},{key:"getNewSnake",value:function(){var e=Math.floor(n.HEIGHT/2);return this.times((function(t){return{x:n.INITIAL_LENGTH+3-t,y:e,eating:!1}}),n.INITIAL_LENGTH)}},{key:"getNewAppleCoords",value:function(){if(this.snake.length!==n.AREA){for(var e;null==e;)e={x:Math.floor(Math.random()*n.WIDTH),y:Math.floor(Math.random()*n.HEIGHT)},this.isAppleOverSnake(e)&&(e=void 0);return e}}},{key:"isAppleOverSnake",value:function(e){return this.snake.reduce((function(t,n){return t||n.x===e.x&&n.y===e.y}),!1)}},{key:"advance",value:function(){var e;this.snake.length===n.AREA&&this.stopAdvancing(n.STATUS.COMPLETE);var t=this.getSnakeHead(),r=null!==(e=this.nextDirection)&&void 0!==e?e:this.currentDirection,i=this.getNextHeadPosition(r);if(this.isHittingWall(i))this.stopAdvancing(n.STATUS.OVER);else if(this.isHittingItself(i))this.stopAdvancing(n.STATUS.OVER);else{for(var s=this.snake.length-1;s>0;s-=1){var o=this.snake[s];s===this.tailIndex&&o.eating&&this.snake.push((0,c.Z)((0,c.Z)({},o),{},{eating:!1}));var a=this.snake[s-1];o.x=a.x,o.y=a.y,o.eating=a.eating}t.x=i.x,t.y=i.y,t.eating=null!=this.apple&&this.apple.x===i.x&&this.apple.y===i.y,t.eating&&(this.apple=this.getNewAppleCoords()),this.nextDirection=void 0,this.currentDirection=r,this.emit(n.EVENT.ADVANCE)}}},{key:"getSnakeHead",value:function(){return this.snake[this.headIndex]}},{key:"isHittingWall",value:function(e){return this.hasWalls&&(e.x<0||e.x>=n.WIDTH||e.y<0||e.y>=n.HEIGHT)}},{key:"isHittingItself",value:function(e){var t=this;return this.snake.reduce((function(n,r,i){return n||(t.tailIndex!==i||r.eating)&&r.x===e.x&&r.y===e.y}),!1)}},{key:"getNextHeadPosition",value:function(e){var t=this.getSnakeHead();switch(e){case n.DIRECTION.U:return{x:t.x,y:this.hasWalls?t.y-1:(t.y+n.HEIGHT-1)%n.HEIGHT};case n.DIRECTION.D:return{x:t.x,y:this.hasWalls?t.y+1:(t.y+1)%n.HEIGHT};case n.DIRECTION.L:return{x:this.hasWalls?t.x-1:(t.x+n.WIDTH-1)%n.WIDTH,y:t.y};case n.DIRECTION.R:return{x:this.hasWalls?t.x+1:(t.x+1)%n.WIDTH,y:t.y};default:throw new Error("Unrecognized direction")}}},{key:"setStatus",value:function(e){this.status=e,this.emit(n.EVENT.STATUS,this.status)}},{key:"start",value:function(){var e=this;if(null!=this.timerId)throw new Error("Game has already started");this.setStatus(n.STATUS.RUNNING),this.timerId=setInterval((function(){e.advance()}),this.refreshSpeed)}},{key:"stopAdvancing",value:function(e){null!=this.timerId&&(clearInterval(this.timerId),this.timerId=void 0),null!=e&&(this.setStatus(e),this.emit(n.EVENT.STOP))}},{key:"stop",value:function(){this.stopAdvancing(n.STATUS.PAUSE)}},{key:"setDirection",value:function(e){this.isNewDirectionValid(e,this.currentDirection)&&(this.nextDirection=e)}},{key:"isNewDirectionValid",value:function(e,t){return t===n.DIRECTION.U&&e!==n.DIRECTION.D||t===n.DIRECTION.D&&e!==n.DIRECTION.U||t===n.DIRECTION.L&&e!==n.DIRECTION.R||t===n.DIRECTION.R&&e!==n.DIRECTION.L}},{key:"goUp",value:function(){this.setDirection(n.DIRECTION.U)}},{key:"goDown",value:function(){this.setDirection(n.DIRECTION.D)}},{key:"goLeft",value:function(){this.setDirection(n.DIRECTION.L)}},{key:"goRight",value:function(){this.setDirection(n.DIRECTION.R)}},{key:"setSpeed",value:function(e){this.speed=e,null!=this.timerId&&(this.stopAdvancing(),this.start())}},{key:"getSnake",value:function(){return this.snake.map((function(e){return{x:e.x,y:e.y}}))}},{key:"getApple",value:function(){return null==this.apple?this.apple:(0,c.Z)({},this.apple)}},{key:"reset",value:function(){this.stopAdvancing(n.STATUS.IDLE),this.snake=this.getNewSnake(),this.apple=this.getNewAppleCoords(),this.nextDirection=n.DIRECTION.R,this.emit(n.EVENT.RESET)}},{key:"setWalls",value:function(e){this.hasWalls=e}}],[{key:"getSnakeGameEnum",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return(0,c.Z)((0,c.Z)({},e),{},(0,r.Z)({},t,Symbol(t)))}),{})}}]),n}(n.n(d)());v.WIDTH=24,v.HEIGHT=17,v.INITIAL_LENGTH=5,v.DIRECTION=v.getSnakeGameEnum("U","D","L","R"),v.STATUS=v.getSnakeGameEnum("IDLE","RUNNING","PAUSE","OVER","COMPLETE"),v.EVENT=v.getSnakeGameEnum("ADVANCE","STOP","RESET","STATUS"),v.AREA=v.WIDTH*v.HEIGHT;var y="lmmGZ",g="MeefJ",m="h7TtO",T="bXAXc",E="gHdgb",S="PvuOZ",I="J6Qdg",x=n(417);function b(e){const t=Object.assign({p:"p",strong:"strong",a:"a",h2:"h2",em:"em"},e.components);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(t.p,{children:["One of my forgotten dreams was to build a clone of Snake that could run on a browser,\nthe one that was included in the Nokia 3210 cellphone.\nYes, ",(0,x.jsx)(t.strong,{children:"the"})," ",(0,x.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Nokia_3210",children:"Nokia 3210"}),",\nthe dad of all cool phones. In 1999 it had interchangeable covers,\nbackground logos and custom ringtones you sent yourself via SMS, and games.\nThe game I liked the most was Snake, at the time we passed hours in buses\nasking to borrow our friend's phones just to try and fill the screen with that Snake,\nmostly because we didn't have cellphones."]}),"\n",(0,x.jsx)(t.h2,{children:"The process"}),"\n",(0,x.jsx)(t.p,{children:"So I started by stating facts: I found some pictures of Snake being played on the 3210,\nand I wrote them down. Measuring the picture I found out that the board is 24x17. Then\nI remembered that the snake got longer only when the eaten fruit reached its tail.\nI cannot recall how it started so I put the snake on the most probable location."}),"\n",(0,x.jsx)(t.p,{children:"Through some iterations I then simplified the calculations. The simplest way to print\nthe game was through a table representing each pixel of the game, unfortunately this\nis pretty heavy (you need to re-render a 308 matrix every iteration knowing that\ngraphically only 3 elements change at most),\nso the next optimization will be to get rid of the table and draw only the elements\nthat need to be changed."}),"\n",(0,x.jsx)(t.h2,{children:"Instructions"}),"\n",(0,x.jsxs)(t.p,{children:["To play on desktop press the ",(0,x.jsx)(t.em,{children:"arrows"}),", ",(0,x.jsx)(t.em,{children:"WSAD"}),", spacebar or\nenter. To pause the game press spacebar or enter, to resume it press\nthe ",(0,x.jsx)(t.em,{children:"arrows"}),", ",(0,x.jsx)(t.em,{children:"WSAD"}),", spacebar or enter. When game is over you can reset\nit by pressing the Reset button or spacebar or enter."]}),"\n",(0,x.jsx)(t.p,{children:"To play on mobile just press the buttons (swipe would be too slow to capture)."})]})}var k=function(e={}){const{wrapper:t}=e.components||{};return t?(0,x.jsx)(t,Object.assign({},e,{children:(0,x.jsx)(b,e)})):b(e)},w=Symbol("E"),N=Symbol("S"),A=Symbol("A"),D=function(e,t){var n=(0,a.DZ1)((function(){return(0,a.DZ1)((function(){return w}),v.WIDTH)}),v.HEIGHT);return e.forEach((function(e){n[e.y][e.x]=N})),null!=t&&(n[t.y][t.x]=A),n},j=function(){var e,t=(0,u.useState)(10),n=(0,i.Z)(t,2),s=n[0],c=n[1],l=(0,u.useState)(!0),h=(0,i.Z)(l,2),f=h[0],p=h[1],d=(0,u.useState)(v.STATUS.IDLE),b=(0,i.Z)(d,2),w=b[0],j=b[1],L=(0,u.useRef)(new v(s,f)),O=(0,u.useState)(D(L.current.getSnake(),L.current.getApple())),R=(0,i.Z)(O,2),C=R[0],U=R[1];(0,u.useEffect)((function(){var e=function(){U(D(L.current.getSnake(),L.current.getApple()))};L.current.addListener(v.EVENT.ADVANCE,e),L.current.addListener(v.EVENT.RESET,e);var t=function(e){j(e)};L.current.addListener(v.EVENT.STATUS,t);var n=function(e){e.preventDefault();var t=L.current.getStatus(),n=t===v.STATUS.IDLE||t===v.STATUS.PAUSE,r=n||t===v.STATUS.RUNNING;switch(e.key){case"ArrowUp":case"w":r&&L.current.goUp(),n&&L.current.start();break;case"ArrowDown":case"s":r&&L.current.goDown(),n&&L.current.start();break;case"ArrowLeft":case"a":r&&L.current.goLeft(),n&&L.current.start();break;case"ArrowRight":case"d":r&&L.current.goRight(),n&&L.current.start();break;case" ":case"Space":case"Enter":n?L.current.start():r?L.current.stop():(L.current.reset(),L.current.start())}};return document.addEventListener("keyup",n),function(){L.current.removeListener(v.EVENT.ADVANCE,e),L.current.addListener(v.EVENT.STATUS,t),document.removeEventListener("keyup",n)}}),[]),(0,u.useEffect)((function(){L.current.setSpeed(s)}),[s]),(0,u.useEffect)((function(){L.current.setWalls(f)}),[f]),(0,u.useEffect)((function(){var e,t;w===v.STATUS.RUNNING?(document.body.classList.add("stopScrolling"),null===(e=document.querySelector("html"))||void 0===e||e.classList.add("stopScrolling")):(document.body.classList.remove("stopScrolling"),null===(t=document.querySelector("html"))||void 0===t||t.classList.remove("stopScrolling"))}),[w]);var H=(0,u.useCallback)((0,a.bBJ)((function(e){var t=L.current.getStatus(),n=t===v.STATUS.IDLE||t===v.STATUS.PAUSE;(n||t===v.STATUS.RUNNING)&&L.current.setDirection(e),n&&L.current.start()})),[]);return(0,x.jsxs)("div",{children:[(0,x.jsx)(k,{}),(0,x.jsx)("table",{className:o()((e={},(0,r.Z)(e,y,!0),(0,r.Z)(e,g,!f),e)),children:(0,x.jsx)("tbody",{children:(0,a.DZ1)((function(e){return(0,x.jsx)("tr",{children:(0,a.DZ1)((function(t){var n;return(0,x.jsx)("td",{className:o()((n={},(0,r.Z)(n,m,!0),(0,r.Z)(n,T,C[e][t]===N),(0,r.Z)(n,E,C[e][t]===A),n)),children:"\xa0"},"row-".concat(e,"-col-").concat(t,"-board-").concat(C[e][t].toString()))}),v.WIDTH)},"row-".concat(e))}),v.HEIGHT)})}),(0,x.jsxs)("div",{children:[w===v.STATUS.IDLE&&(0,x.jsx)("p",{children:"Insert coin to play..."}),w===v.STATUS.OVER&&(0,x.jsx)("p",{children:(0,x.jsx)("strong",{children:"GAME OVER."})}),w===v.STATUS.COMPLETE&&(0,x.jsx)("p",{children:(0,x.jsx)("strong",{children:"And that's how it's done."})}),w===v.STATUS.PAUSE&&(0,x.jsx)("p",{children:"Do your thing, I'll wait here..."}),w===v.STATUS.RUNNING&&(0,x.jsx)("p",{children:"Run Forrest, Run!"})]}),(0,x.jsxs)("div",{className:S,children:[(0,x.jsx)("div",{children:(0,x.jsx)("button",{onClick:H(v.DIRECTION.U),children:"Up"})}),(0,x.jsxs)("div",{className:I,children:[(0,x.jsx)("div",{children:(0,x.jsx)("button",{onClick:H(v.DIRECTION.L),children:"Left"})}),(0,x.jsx)("div",{children:(0,x.jsx)("button",{onClick:H(v.DIRECTION.R),children:"Right"})})]}),(0,x.jsx)("div",{children:(0,x.jsx)("button",{onClick:H(v.DIRECTION.D),children:"Down"})})]}),(0,x.jsx)("div",{children:(0,x.jsxs)("fieldset",{children:[(0,x.jsx)("legend",{children:"Settings"}),(0,x.jsx)("label",{htmlFor:"speed",children:"Speed:"})," ",(0,x.jsx)("input",{id:"speed",type:"number",onChange:function(e){var t=parseInt(e.target.value);c(Math.max(1,isNaN(t)?1:t))},value:s})," ",(0,x.jsx)("input",{id:"hasWalls",name:"hasWalls",checked:f,onChange:function(e){p(e.target.checked)},type:"checkbox",value:"hasWalls"})," ",(0,x.jsx)("label",{htmlFor:"hasWalls",children:"Has walls"})," ",(0,x.jsx)("button",{type:"button",onClick:function(){L.current.reset()},children:"Reset"})]})})]})}},123:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var s=typeof n;if("string"===s||"number"===s)e.push(n);else if(Array.isArray(n)){if(n.length){var o=i.apply(null,n);o&&e.push(o)}}else if("object"===s){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var a in n)r.call(n,a)&&n[a]&&e.push(a)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},41:function(e){"use strict";var t,n="object"===typeof Reflect?Reflect:null,r=n&&"function"===typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"===typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,s),r(n)}function s(){"function"===typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}v(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&v(e,"error",t,n)}(e,i,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var i,s,o,c;if(a(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"===typeof o?o=s[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=u(e))>0&&o.length>i&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function f(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):d(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function d(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function v(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){r.once&&e.removeEventListener(t,i),n(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=s[e];if(void 0===u)return!1;if("function"===typeof u)r(u,this,t);else{var c=u.length,l=d(u,c);for(n=0;n<c;++n)r(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,s,o;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},942:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return r}})},413:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(942);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}}}]);